<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNAP Connection Manager - User Guide</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: 1.5em;
        }
        h1 { font-size: 2.2em; margin-bottom: 0.5em; }
        h2 { font-size: 1.75em; }
        h3 { font-size: 1.4em; border-bottom: none; color: #34495e; margin-bottom: 0.5em; }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        code {
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            background-color: #e8e8e8;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #d63384;
        }
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.95em;
        }
        .toc {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 2em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .toc h2 {
            margin-top: 0;
            border-bottom: none;
            font-size: 1.5em;
        }
        .toc ul, .toc ol {
            padding-left: 20px;
        }
        .feature-box {
            background: #fff;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        li {
            margin-bottom: 0.5em;
        }
        .note {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>

    <h1>SNAP Connection Manager v1.2.8</h1>
    <p><strong>User & Technical Guide</strong></p>

    <div class="toc">
        <h2>Table of Contents</h2>
        <ol>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#management">Server & Folder Management</a></li>
            <li><a href="#connection">Connection & Automation Features</a>
                <ul>
                    <li><a href="#conn-terminal">The VTE Terminal</a></li>
                    <li><a href="#conn-live-settings">Live Settings (In-Session)</a></li>
                    <li><a href="#conn-startup">Startup Command Files</a></li>
                    <li><a href="#conn-automation">Login Automation (Expect)</a></li>
                    <li><a href="#conn-forwarding">Port Forwarding</a></li>
                </ul>
            </li>
            <li><a href="#logging">Logging & Data Management</a>
                <ul>
                    <li><a href="#log-session">Clean Session Logging</a></li>
                    <li><a href="#log-export">Import / Export</a></li>
                </ul>
            </li>
            <li><a href="#encryption">Security & Encryption</a></li>
            <li><a href="#appearance">Appearance & Customization</a></li>
            <li><a href="#installation">Installation</a></li>
        </ol>
    </div>

    <h2 id="introduction">1. Introduction</h2>
    <p>Welcome to the <strong>SNAP Connection Manager</strong>, a professional-grade GTK3 application designed for managing SSH and SFTP connections. It combines a secure, encrypted database with a high-performance terminal emulator, allowing system administrators and developers to organize, automate, and monitor their connections with ease.</p>

    <h2 id="management">2. Server & Folder Management</h2>
    <p>SNAP allows you to organize hundreds of servers into a logical hierarchy. The main interface is built around a "Session" tree view.</p>
    
    <div class="feature-box">
        <h3>Organization Tools</h3>
        <ul>
            <li><strong>Folders:</strong> Create custom folders to group servers (e.g., "Production", "Staging", "AWS"). Servers not in a folder appear in the root.</li>
            <li><strong>Drag-and-Drop:</strong> Move servers between folders or reorder them by simply dragging them with your mouse.</li>
            <li><strong>Natural Sorting:</strong> The list automatically sorts items intelligently (e.g., <code>Web-2</code> comes before <code>Web-10</code>).</li>
        </ul>
    </div>

    <div class="feature-box">
        <h3>Editing & Actions</h3>
        <ul>
            <li><strong>Inline Renaming:</strong> Click a selected server or folder (wait 1 second after selecting) to rename it directly in the tree, or press <code>F2</code>.</li>
            <li><strong>Copy/Paste:</strong> 
                <ul>
                    <li>Right-click a server and select <strong>Copy Server</strong> (or press <code>Ctrl+C</code>).</li>
                    <li>Select a destination folder and choose <strong>Paste Server</strong> (or press <code>Ctrl+V</code>). This creates a deep copy with a unique name.</li>
                </ul>
            </li>
            <li><strong>Context Menus:</strong> Right-click any item to access specific actions like Connect, Edit, or Delete.</li>
        </ul>
    </div>

    <h2 id="connection">3. Connection & Automation Features</h2>

    <h3 id="conn-terminal">3.1 The VTE Terminal</h3>
    <p>Connections launch in a native, hardware-accelerated terminal window based on the <strong>VTE</strong> library (the same engine used by GNOME Terminal). It supports:</p>
    <ul>
        <li><strong>256 Colors & TrueColor:</strong> Full support for rich terminal applications like <code>htop</code>, <code>vim</code>, and <code>tmux</code>.</li>
        <li><strong>Smart Resize:</strong> The local terminal window size is synchronized with the remote host (<code>SIGWINCH</code>), ensuring text wraps correctly when you resize the window.</li>
        <li><strong>Anti-Idle:</strong> Keep connections alive by automatically sending a "keepalive" character (default: a hidden null packet or newline) at a set interval. Configurable in the <strong>Terminal</strong> tab.</li>
    </ul>

    <h3 id="conn-live-settings">3.2 Live Settings (In-Session)</h3>
    <p>You can adjust a server's configuration without disconnecting.</p>
    <ul>
        <li>Look for the <strong>Menu Button</strong> (<span style="font-size:1.2em">≡</span>) in the header bar of any active terminal window.</li>
        <li>Clicking this opens the <strong>Edit Server</strong> dialog for that active connection.</li>
        <li><strong>Instant Apply:</strong> If you change the Font, Color Scheme, or Scrollback limit and click <strong>OK</strong>, the open window updates immediately to reflect your changes.</li>
    </ul>

    <h3 id="conn-startup">3.3 Startup Command Files</h3>
    <p>Located in the <strong>Terminal</strong> tab of the Server Editor, this feature allows you to automate post-login tasks.</p>
    <ul>
        <li><strong>How it works:</strong> Select a local text file on your computer.</li>
        <li><strong>Execution:</strong> Immediately after logging in, SNAP reads the file and types each line into the terminal automatically.</li>
        <li><strong>Use Cases:</strong>
            <ul>
                <li>Setting environment variables (<code>export TERM=xterm-256color</code>).</li>
                <li>Sourcing custom scripts (<code>source ~/.my_aliases</code>).</li>
                <li>Navigating to a deep directory structure (<code>cd /var/www/html/project/logs</code>).</li>
                <li>Running system health checks (<code>htop</code> or <code>docker ps</code>).</li>
            </ul>
        </li>
    </ul>

    <h3 id="conn-automation">3.4 Login Automation (Expect)</h3>
    <p>For servers that require complex authentication steps (like 2FA prompts, legal disclaimers, or sudo passwords), use the <strong>Login Actions</strong> tab.</p>
    <ul>
        <li><strong>Expect:</strong> Define a text string the application should wait for (e.g., <code>Verification code:</code>).</li>
        <li><strong>Send:</strong> Define the response to type (e.g., your code).</li>
        <li><strong>Hide:</strong> Check this box to prevent the sent text from appearing in the log or screen (useful for passwords).</li>
    </ul>

    <h3 id="conn-forwarding">3.5 Port Forwarding</h3>
    <p>Tunnel traffic securely through your SSH connection using the <strong>Port Forwarding</strong> tab.</p>
    <ul>
        <li><strong>Local (-L):</strong> Access a service on the remote network (e.g., an internal web dashboard) via <code>localhost</code> on your machine.</li>
        <li><strong>Remote (-R):</strong> Expose a local service on your machine to the remote server.</li>
        <li><strong>Dynamic (-D):</strong> Creates a SOCKS proxy that allows you to route browser traffic through the remote server.</li>
    </ul>

    <h2 id="logging">4. Logging & Data Management</h2>

    <h3 id="log-session">4.1 Clean Session Logging</h3>
    <p>SNAP features a sophisticated logging engine designed for troubleshooting and auditing.</p>
    <ul>
        <li><strong>Enable Logging:</strong> In the <strong>Terminal</strong> tab, check "Enable Logging" and select a file path.</li>
        <li><strong>Modes:</strong>
            <ul>
                <li><strong>Append:</strong> Adds new session data to the end of the file. Useful for keeping a history of multiple sessions.</li>
                <li><strong>Overwrite:</strong> Wipes the file clean every time you connect. Perfect for "current state" debugging.</li>
            </ul>
        </li>
        <li><strong>"Clean Text" Technology:</strong> The application automatically strips out terminal control codes (ANSI colors, progress bars, window title updates) in real-time. The resulting log file is clean, human-readable text, perfect for use with <code>grep</code> or sharing with colleagues.</li>
    </ul>

    <h3 id="log-export">4.2 Import / Export</h3>
    <p>Backup or share your configuration via the <strong>File</strong> menu.</p>
    <ul>
        <li><strong>JSON Export:</strong> Saves a plaintext <code>.json</code> file. <em>Warning: This includes passwords in plain text.</em></li>
        <li><strong>GPG Export:</strong> Saves an encrypted <code>.json.gpg</code> file. You will be prompted for the Master Passphrase to encrypt it. This allows you to safely move your configuration between computers.</li>
    </ul>

    <h2 id="encryption">5. Security & Encryption</h2>
    <p>Your credentials are protected by industry-standard cryptography.</p>
    <ul>
        <li><strong>Storage:</strong> Data is saved in <code>~/.local/share/snap_connection_manager/ssh_servers.json.gpg</code>.</li>
        <li><strong>Algorithm:</strong> The file is encrypted using <strong>AES256</strong> via GnuPG.</li>
        <li><strong>Keys:</strong> Your Master Passphrase is hashed using <strong>PBKDF2-HMAC-SHA256</strong> (600,000 iterations) with a unique salt to derive the encryption key.</li>
        <li><strong>Memory Safety:</strong> Passwords are decrypted only in RAM and are never written to disk in plain text during normal operation.</li>
    </ul>

    <h2 id="appearance">6. Appearance & Customization</h2>
    <p>Make the terminal your own via the <strong>Appearance</strong> tab.</p>
    <ul>
        <li><strong>Palettes:</strong> Choose from built-in schemes like <em>Solarized</em>, <em>Tango</em>, or <em>GNOME</em>, or define custom foreground/background colors.</li>
        <li><strong>Fonts:</strong> Select any monospaced font installed on your system.</li>
        <li><strong>Defaults:</strong> Set your preferred baseline settings in <code>File -> Default Settings...</code>. New servers will automatically inherit these choices.</li>
    </ul>

    <h2 id="installation">7. Installation</h2>
    <p>To install or update to the latest version:</p>
    <pre><code>curl -sL https://raw.githubusercontent.com/larreblarsson/SNAP-Connection-Manager/main/install.sh | bash</code></pre>

    <p class="note">© 2025 SNAP Connection Manager. Built with Python & GTK3.</p>

</body>
</html>
